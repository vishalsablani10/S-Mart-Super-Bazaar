<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- (FIX) Add Meta Tags to prevent browser caching -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />

    <title>S-Mart Super Bazaar Order Form</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
    </style>
</head>
<body class="bg-gray-100">

    <div class="container mx-auto p-4 sm:p-6 lg:p-8 max-w-4xl">
        <div class="bg-white rounded-2xl shadow-lg p-6 md:p-8">
            
            <!-- Header -->
            <div class="text-center mb-8">
                <h1 id="storeName" class="text-3xl sm:text-4xl font-bold text-gray-800">S-Mart Super Bazaar</h1>
                <p class="text-gray-500 mt-2">Create your order by selecting items below</p>
            </div>

            <!-- Item Selection Section -->
            <div class="bg-gray-50 p-6 rounded-xl mb-8 border border-gray-200">
                <h2 class="text-xl font-semibold text-gray-700 mb-4">Select an Item</h2>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                    <div>
                        <label for="category" class="block text-sm font-medium text-gray-600 mb-1">Category</label>
                        <select id="category" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition">
                            <option value="">-- Select Category --</option>
                        </select>
                    </div>
                    <div>
                        <label for="product" class="block text-sm font-medium text-gray-600 mb-1">Product</label>
                        <select id="product" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition" disabled>
                            <option value="">-- Select Product --</option>
                        </select>
                    </div>
                    <div>
                        <label for="brand" class="block text-sm font-medium text-gray-600 mb-1">Brand</label>
                        <select id="brand" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition" disabled>
                            <option value="">-- Select Brand --</option>
                        </select>
                    </div>
                </div>
                <button id="addItemBtn" class="w-full bg-blue-600 text-white font-semibold py-3 px-4 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition duration-300 disabled:bg-gray-400" disabled>
                    Add Item to Order
                </button>
            </div>

            <!-- Order Summary Section -->
            <div>
                <h2 class="text-2xl font-semibold text-gray-800 mb-4">Your Order</h2>
                <div id="order-summary-placeholder" class="text-center text-gray-500 py-8 border-2 border-dashed border-gray-300 rounded-lg">
                    <p>Your items will appear here once added.</p>
                </div>
                <div class="overflow-x-auto hidden" id="order-table-container">
                    <table class="min-w-full bg-white rounded-lg">
                        <thead class="bg-gray-100">
                            <tr>
                                <th class="text-left font-semibold text-gray-600 p-3">Product</th>
                                <th class="text-center font-semibold text-gray-600 p-3">Quantity</th>
                                <th class="text-center font-semibold text-gray-600 p-3">Action</th>
                            </tr>
                        </thead>
                        <tbody id="order-items">
                            <!-- Order items will be dynamically inserted here -->
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- Customer Details -->
            <div class="mt-8 bg-gray-50 p-6 rounded-xl border border-gray-200">
                 <h2 class="text-xl font-semibold text-gray-700 mb-4">Your Details</h2>
                 <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                     <div>
                        <label for="customerName" class="block text-sm font-medium text-gray-600 mb-1">Full Name</label>
                        <input type="text" id="customerName" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition" placeholder="Enter your name">
                     </div>
                     <div>
                        <label for="customerAddress" class="block text-sm font-medium text-gray-600 mb-1">Delivery Address</label>
                        <input type="text" id="customerAddress" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition" placeholder="Enter your address">
                     </div>
                 </div>
            </div>


            <!-- Submit Button -->
            <div class="mt-8 text-center">
                <button id="submitOrderBtn" class="w-full md:w-auto bg-green-600 text-white font-bold py-4 px-10 rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition duration-300 text-lg disabled:bg-gray-400 flex items-center justify-center gap-3 mx-auto" disabled>
                     <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M.057 24l1.687-6.163c-1.041-1.804-1.588-3.849-1.587-5.946.003-6.556 5.338-11.891 11.893-11.891 3.181.001 6.167 1.24 8.413 3.488 2.245 2.248 3.481 5.236 3.48 8.414-.003 6.557-5.338 11.892-11.894 11.892-1.99-.001-3.951-.5-5.688-1.448l-6.305 1.654zm6.597-3.807c1.676.995 3.276 1.591 5.392 1.592 5.448 0 9.886-4.434 9.889-9.885.002-5.462-4.415-9.89-9.881-9.892-5.452 0-9.887 4.434-9.889 9.886-.001 2.269.655 4.512 1.916 6.438l-.895 3.251 3.343-.876z"/></svg>
                    Send Order via WhatsApp
                </button>
            </div>
        </div>
    </div>

    <script>
        // =================================================================================
        // --- ⚙️ CONFIGURATION - EDIT THIS SECTION ⚙️ ---
        // =================================================================================

        // 1. Enter your store name
        const STORE_NAME = "S-Mart Super Bazaar";

        // 2. Enter your WhatsApp number (with country code, no '+', spaces or symbols)
        const WHATSAPP_NUMBER = "918687146484";

        // 3. Add your product inventory here
        // Structure: Category -> Product -> [Brand1, Brand2, ...]
        const inventory = {
            "Grocery": {
                "गुड़ क्यूब्स": ["Brand A", "Brand B", "Brand C"], "गुड़ पावडर": ["Brand A", "Brand B", "Brand C"], "चावल": ["Brand A", "Brand B", "Brand C"], "गेहूं": ["Brand A", "Brand B", "Brand C"], "शक्कर": ["Brand A", "Brand B", "Brand C"], "पिसी शक्कर": ["Brand A", "Brand B", "Brand C"], "शकर बुरा": ["Brand A", "Brand B", "Brand C"], "मिश्री क्रिस्टल": ["Brand A", "Brand B", "Brand C"], "मिश्री धागा": ["Brand A", "Brand B", "Brand C"], "शकर फूटना": ["Brand A", "Brand B", "Brand C"], "तेल": ["Brand A", "Brand B", "Brand C"], "डालडा घी": ["Brand A", "Brand B", "Brand C"], "देसी घी भैंस": ["Brand A", "Brand B", "Brand C"], "देसी घी गाय": ["Brand A", "Brand B", "Brand C"], "चाय": ["Brand A", "Brand B", "Brand C"]
            },
            "Masala": {
                "अखी मिर्ची": ["Brand A", "Brand B", "Brand C"], "पटना मिर्ची पावडर": ["Brand A", "Brand B", "Brand C"], "कश्मीरी मिर्ची पावडर": ["Brand A", "Brand B", "Brand C"], "अखा धनिया": ["Brand A", "Brand B", "Brand C"], "धनिया पाउडर": ["Brand A", "Brand B", "Brand C"], "अखी हल्दी": ["Brand A", "Brand B", "Brand C"], "हल्दी पावडर": ["Brand A", "Brand B", "Brand C"], "हींग": ["Brand A", "Brand B", "Brand C"], "हरी इलायची": ["Brand A", "Brand B", "Brand C"], "इलायची पावडर": ["Brand A", "Brand B", "Brand C"], "बड़ी इलायची": ["Brand A", "Brand B", "Brand C"], "इलायची दाना": ["Brand A", "Brand B", "Brand C"]
            },
            "Dry fruit": {
                "अमेरिकन बादाम": ["Brand A", "Brand B", "Brand C"], "सनोरा बादाम": ["Brand A", "Brand B", "Brand C"], "रामू ममरा बादाम": ["Brand A", "Brand B", "Brand C"], "बादाम कतरन": ["Brand A", "Brand B", "Brand C"], "नमकीन बादाम": ["Brand A", "Brand B", "Brand C"], "काजू": ["Brand A", "Brand B", "Brand C"], "काजू फॉल 2pc": ["Brand A", "Brand B", "Brand C"], "काजू टुकड़ी": ["Brand A", "Brand B", "Brand C"], "नमकीन काजू": ["Brand A", "Brand B", "Brand C"], "नमकीन पिस्ता": ["Brand A", "Brand B", "Brand C"], "ग्रीन पिस्ता": ["Brand A", "Brand B", "Brand C"], "पिस्ता कतरन": ["Brand A", "Brand B", "Brand C"]
            }
        };

        // =================================================================================
        // --- APPLICATION LOGIC - DO NOT EDIT BELOW THIS LINE ---
        // =================================================================================

        document.addEventListener('DOMContentLoaded', () => {
            // --- Element References ---
            const storeNameEl = document.getElementById('storeName');
            const categorySelect = document.getElementById('category');
            const productSelect = document.getElementById('product');
            const brandSelect = document.getElementById('brand');
            const addItemBtn = document.getElementById('addItemBtn');
            const orderItemsBody = document.getElementById('order-items');
            const orderPlaceholder = document.getElementById('order-summary-placeholder');
            const orderTableContainer = document.getElementById('order-table-container');
            const submitOrderBtn = document.getElementById('submitOrderBtn');
            const customerNameInput = document.getElementById('customerName');
            const customerAddressInput = document.getElementById('customerAddress');

            let order = {}; // To store the current order details

            // --- Initial Setup ---
            function setup() {
                storeNameEl.textContent = STORE_NAME;
                populateCategories();
                updateSubmitButtonState();
            }

            // --- Dropdown Population ---
            function populateCategories() {
                Object.keys(inventory).forEach(category => {
                    const option = document.createElement('option');
                    option.value = category;
                    option.textContent = category;
                    categorySelect.appendChild(option);
                });
            }

            function updateProducts() {
                const selectedCategory = categorySelect.value;
                productSelect.innerHTML = '<option value="">-- Select Product --</option>';
                brandSelect.innerHTML = '<option value="">-- Select Brand --</option>';
                productSelect.disabled = true;
                brandSelect.disabled = true;

                if (selectedCategory && inventory[selectedCategory]) {
                    Object.keys(inventory[selectedCategory]).forEach(product => {
                        const option = document.createElement('option');
                        option.value = product;
                        option.textContent = product;
                        productSelect.appendChild(option);
                    });
                    productSelect.disabled = false;
                }
                updateAddItemButtonState();
            }

            function updateBrands() {
                const selectedCategory = categorySelect.value;
                const selectedProduct = productSelect.value;
                brandSelect.innerHTML = '<option value="">-- Select Brand --</option>';
                brandSelect.disabled = true;

                if (selectedCategory && selectedProduct && inventory[selectedCategory][selectedProduct]) {
                    inventory[selectedCategory][selectedProduct].forEach(brand => {
                        const option = document.createElement('option');
                        option.value = brand;
                        option.textContent = brand;
                        brandSelect.appendChild(option);
                    });
                    brandSelect.disabled = false;
                }
                updateAddItemButtonState();
            }

            // --- UI State Management ---
            function updateAddItemButtonState() {
                addItemBtn.disabled = !(categorySelect.value && productSelect.value && brandSelect.value);
            }
            
            function updateSubmitButtonState() {
                const hasItems = Object.keys(order).length > 0;
                submitOrderBtn.disabled = !hasItems;
            }

            function updateOrderSummaryVisibility() {
                const hasItems = Object.keys(order).length > 0;
                orderPlaceholder.classList.toggle('hidden', hasItems);
                orderTableContainer.classList.toggle('hidden', !hasItems);
            }

            // --- Order Management ---
            function addItemToOrder() {
                const category = categorySelect.value;
                const product = productSelect.value;
                const brand = brandSelect.value;
                
                if (!category || !product || !brand) return;

                const orderKey = `${product} (${brand})`;

                if (order[orderKey]) {
                    order[orderKey].quantity++;
                } else {
                    order[orderKey] = {
                        category,
                        product,
                        brand,
                        quantity: 1,
                        unit: 'PC' // Default unit
                    };
                }
                renderOrder();
                resetSelectors();
            }

            function removeItemFromOrder(orderKey) {
                delete order[orderKey];
                renderOrder();
            }
            
            function updateQuantity(orderKey, newQuantity) {
                if (order[orderKey]) {
                    const qty = parseFloat(newQuantity);
                    if (qty > 0) {
                        order[orderKey].quantity = qty;
                    } else {
                        removeItemFromOrder(orderKey);
                    }
                }
            }

            function updateUnit(orderKey, newUnit) {
                if (order[orderKey]) {
                    order[orderKey].unit = newUnit;
                }
            }

            function renderOrder() {
                orderItemsBody.innerHTML = '';
                Object.keys(order).forEach(key => {
                    const item = order[key];
                    const row = document.createElement('tr');
                    row.className = 'border-b border-gray-200';
                    row.innerHTML = `
                        <td class="p-3">
                            <div class="font-medium text-gray-800">${item.product}</div>
                            <div class="text-sm text-gray-500">${item.brand} - ${item.category}</div>
                        </td>
                        <td class="p-3 text-center">
                            <div class="flex items-center justify-center gap-2">
                                <input type="number" value="${item.quantity}" min="0.1" step="0.1" class="w-20 text-center border border-gray-300 rounded-md p-1 quantity-input" data-key="${key}">
                                <select class="border border-gray-300 rounded-md p-1 unit-select" data-key="${key}">
                                    <option value="PC" ${item.unit === 'PC' ? 'selected' : ''}>PC</option>
                                    <option value="KG" ${item.unit === 'KG' ? 'selected' : ''}>KG</option>
                                </select>
                            </div>
                        </td>
                        <td class="p-3 text-center">
                            <button class="text-red-500 hover:text-red-700 remove-btn" data-key="${key}">Remove</button>
                        </td>
                    `;
                    orderItemsBody.appendChild(row);
                });
                updateOrderSummaryVisibility();
                updateSubmitButtonState();
            }
            
            function resetSelectors() {
                categorySelect.value = "";
                productSelect.innerHTML = '<option value="">-- Select Product --</option>';
                brandSelect.innerHTML = '<option value="">-- Select Brand --</option>';
                productSelect.disabled = true;
                brandSelect.disabled = true;
                updateAddItemButtonState();
            }

            // --- Submission Logic ---
            function generateOrderMessage() {
                const customerName = customerNameInput.value.trim();
                const customerAddress = customerAddressInput.value.trim();
                
                if (!customerName || !customerAddress) {
                    alert("Please enter your name and address before submitting.");
                    return null;
                }

                let message = `*New Order for ${STORE_NAME}*\n\n`;
                message += `*Customer Name:* ${customerName}\n`;
                message += `*Address:* ${customerAddress}\n\n`;
                message += "--- *Order Details* ---\n";
                
                Object.values(order).forEach(item => {
                    message += `• ${item.product} (${item.brand}) - *Qty: ${item.quantity} ${item.unit}*\n`;
                });
                
                message += "\nThank you!";
                return message;
            }

            function submitViaWhatsapp() {
                const message = generateOrderMessage();
                if (!message) return;
                const encodedMessage = encodeURIComponent(message);
                const url = `https://wa.me/${WHATSAPP_NUMBER}?text=${encodedMessage}`;
                window.open(url, '_blank');
            }

            // --- Event Listeners ---
            categorySelect.addEventListener('change', updateProducts);
            productSelect.addEventListener('change', updateBrands);
            brandSelect.addEventListener('change', updateAddItemButtonState);
            addItemBtn.addEventListener('click', addItemToOrder);
            
            orderItemsBody.addEventListener('click', (e) => {
                if (e.target.classList.contains('remove-btn')) {
                    removeItemFromOrder(e.target.dataset.key);
                }
            });
            
            orderItemsBody.addEventListener('change', (e) => {
                if (e.target.classList.contains('quantity-input')) {
                    updateQuantity(e.target.dataset.key, e.target.value);
                }
                if (e.target.classList.contains('unit-select')) {
                    updateUnit(e.target.dataset.key, e.target.value);
                }
            });
            
            submitOrderBtn.addEventListener('click', submitViaWhatsapp);


            // --- Start the application ---
            setup();
        });
    </script>
</body>
</html>
